(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{480:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/logo.8bb06c97.svg"},481:function(e,t,n){},490:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(42),i=n.n(c),o=n(13);var u,s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=Object(r.useState)(e),a=Object(o.a)(n,2),c=a[0],i=a[1];return Object(r.useEffect)((function(){var n;return n=setTimeout((function(){i(e)}),t),function(){clearTimeout(n)}}),[e,t]),c},d=n(9),l=n.n(d),j=n(29),b=n(10),f=n(47),p=n(278),O=n.n(p),m=function(e){return null===e||void 0===e||""===e},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(b.a)({},e);return Object.keys(t).forEach((function(e){var n=t[e];m(n)&&delete t[e]})),t},v=["data","token","headers"],x=function(){var e=Object(j.a)(l.a.mark((function e(t){var n,r,a,c,i,o,u=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{},a=r.data,c=r.token,r.headers,i=Object(f.a)(r,v),o=Object(b.a)({method:"GET",headers:{Authorization:c?"Bearer ".concat(c):"","Content-Type":a?"application/json":""}},i),"GET"===(null===(n=o.method)||void 0===n?void 0:n.toUpperCase())?t+="?".concat(O.a.stringify(h(a))):o.body=JSON.stringify(h(a)||{}),e.abrupt("return",window.fetch("".concat("","/").concat(t),o).then(function(){var e=Object(j.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.status){e.next=5;break}return e.next=3,w();case 3:return window.location.reload(),e.abrupt("return",Promise.reject());case 5:return e.next=7,t.json();case 7:if(n=e.sent,!t.ok){e.next=12;break}return e.abrupt("return",n);case 12:return e.abrupt("return",Promise.reject(n));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g="__auth_provider_token__",y=function(e){var t=e.user;return window.localStorage.setItem(g,t.token||""),t},w=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.localStorage.removeItem(g));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(j.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!(n=window.localStorage.getItem(g))){e.next=7;break}return e.next=5,x("me",{token:n});case 5:r=e.sent,t=r.user;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=n(177),C=n(30),L=n(31),E=L.a.div(u||(u=Object(C.a)(["\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),_=n(2),T=function(){return Object(_.jsx)(E,{children:Object(_.jsx)(k.a,{size:"large"})})},M=n(498),S=function(e){var t,n=e.error;return(null===(t=n)||void 0===t?void 0:t.message)?Object(_.jsx)(M.a.Text,{type:"danger",children:n.message}):null},N=function(e){var t=e.error;return Object(_.jsx)(E,{children:Object(_.jsx)(S,{error:t})})},P=n(32),D=a.a.createContext(void 0);D.displayName="AuthContext";var F=function(e){var t,n=e.children,a=B(),c=a.data,i=a.isLoading,o=a.isError,u=a.error,s=a.run,d=a.setData,b=Object(P.useQueryClient)();return t=Object(r.useCallback)((function(){s(I())}),[s]),Object(r.useEffect)((function(){t()}),[t]),i?Object(_.jsx)(T,{}):o?Object(_.jsx)(N,{error:u||new Error}):Object(_.jsx)(D.Provider,{value:{user:c,login:function(e){return function(e){return fetch("".concat("","/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(){var e=Object(j.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=8;break}return e.t0=y,e.next=4,t.json();case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:return e.t2=Promise,e.next=11,t.json();case 11:return e.t3=e.sent,e.abrupt("return",e.t2.reject.call(e.t2,e.t3));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}(e).then(d)},register:function(e){return function(e){return fetch("".concat("","/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(){var e=Object(j.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=8;break}return e.t0=y,e.next=4,t.json();case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:return e.t2=Promise,e.next=11,t.json();case 11:return e.t3=e.sent,e.abrupt("return",e.t2.reject.call(e.t2,e.t3));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}(e).then(d)},logout:function(){return w().then((function(){b.clear(),d(null)}))}},children:n})},Q=function(){var e=Object(r.useContext)(D);if(!e)throw new Error("useAuth need use in AuthProvider");return e},q=function(){var e=Q().user;return Object(r.useCallback)((function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0],c=n[1];return x(a,Object(b.a)(Object(b.a)({},c),{},{token:null===e||void 0===e?void 0:e.token}))}),[e])},R={stat:"idle",data:null,error:null},A={throwOnError:!1},z=function(e){var t=function(){var e=Object(r.useRef)(!1);return Object(r.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),{mountedRef:e}}().mountedRef;return Object(r.useCallback)((function(){t.current&&e.apply(void 0,arguments)}),[t,e])},B=function(e,t){var n=Object(b.a)(Object(b.a)({},A),t),a=Object(r.useReducer)((function(e,t){return Object(b.a)(Object(b.a)({},e),t)}),Object(b.a)(Object(b.a)({},R),e)),c=Object(o.a)(a,2),i=c[0],u=c[1],s=z(u),d=Object(r.useState)((function(){return function(){}})),l=Object(o.a)(d,2),j=l[0],f=l[1],p=Object(r.useCallback)((function(e){return s({data:e,stat:"success",error:null})}),[s]),O=Object(r.useCallback)((function(e){return s({error:e,stat:"error",data:null})}),[s]),m=Object(r.useCallback)((function(e,t){if(!e||!e.then)throw new Error("\u9700\u50b3\u5165promise\u985e\u578b");return f((function(){return function(){(null===t||void 0===t?void 0:t.retry)&&m(t.retry(),t)}})),s({stat:"loading"}),e.then((function(e){return p(e),e})).catch((function(e){return O(e),!0===n.throwOnError?Promise.reject(e):e}))}),[n.throwOnError,s,O,p]);return Object(b.a)(Object(b.a)({isIdle:"idle"===i.stat,isSuccess:"success"===i.stat,isError:"error"===i.stat,isLoading:"loading"===i.stat,run:m,setData:p,setError:O},i),{},{retry:j})};function Z(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Object(r.useRef)(document.title).current;Object(r.useEffect)((function(){document.title=e}),[e]),Object(r.useEffect)((function(){return function(){t||(document.title=n)}}),[t,n])}var H=n(106),J=n(64),K=function(){var e=Object(J.c)(),t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(r.useCallback)((function(e){var t=h(Object(b.a)(Object(b.a)({},Object.fromEntries(n)),e));return a(t)}),[a,n])},V=function(e){var t=Object(J.c)(),n=Object(o.a)(t,1)[0],a=K(),c=Object(r.useState)(e),i=Object(o.a)(c,1)[0];return[Object(r.useMemo)((function(){return i.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(H.a)({},t,n.get(t)||""))}),{})}),[n,i]),Object(r.useCallback)((function(e){return a(e)}),[a])]},W=n(40);function U(e){var t=q();return Object(P.useQuery)(["projects",h(e)],(function(){return t("projects",{data:e})}))}function Y(e){var t=q();return Object(P.useMutation)((function(e){return t("projects/".concat(e.id),{data:e,method:"PATCH"})}),oe(e))}function G(e){var t=q(),n=Object(P.useQueryClient)();return Object(P.useMutation)((function(e){return t("projects",{data:e,method:"POST"})}),{onSuccess:function(t){var r=n.getQueryData(e);n.setQueryData(e,[].concat(Object(W.a)(r),[t]))}})}var X,$,ee=function(e){var t=q();return Object(P.useQuery)(["project",{id:e}],(function(){return t("projects/".concat(e))}),{enabled:!!e})},te=function(){var e=V(["projectCreate"]),t=Object(o.a)(e,2),n=t[0].projectCreate,r=t[1],a=K(),c=V(["editingProjectId"]),i=Object(o.a)(c,2),u=i[0].editingProjectId,s=i[1],d=ee(Number(u)),l=d.data,j=d.isLoading;return{projectModalOpen:"true"===n||Boolean(u),open:function(){return r({projectCreate:!0})},close:function(){a({projectCreate:"",editingProjectId:""})},startEdit:function(e){s({editingProjectId:e})},editingProject:l,isLoading:j}},ne=function(e){var t=e.fromId,n=e.type,r=e.referenceId,a=e.list,c=Object(W.a)(a),i=c.findIndex((function(e){return e.id===t}));if(!r)return ae(Object(W.a)(c),i,c.length-1);var o=c.findIndex((function(e){return e.id===r}));return("after"===n?ae:re)(Object(W.a)(c),i,o)},re=function(e,t,n){var r=e[n],a=e.splice(t,1)[0],c=e.indexOf(r);return e.splice(c,0,a),e},ae=function(e,t,n){var r=e[n],a=e.splice(t,1)[0],c=e.indexOf(r);return e.splice(c+1,0,a),e},ce=function(e,t){var n=Object(P.useQueryClient)();return{onMutate:function(r){return Object(j.a)(l.a.mark((function a(){var c;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.setQueryData(e,(function(e){return t(r,e)})),c=n.getQueryData(e),a.abrupt("return",{previousItem:c});case 3:case"end":return a.stop()}}),a)})))()},onError:function(t,r,a){n.setQueryData(e,a.previousItem)}}},ie=function(e){return ce(e,(function(e,t){return(null===t||void 0===t?void 0:t.filter((function(t){return t.id!==e.id})))||[]}))},oe=function(e){return ce(e,(function(e,t){return(null===t||void 0===t?void 0:t.map((function(t){return t.id===e.id?Object(b.a)(Object(b.a)({},t),e):t})))||[]}))},ue=function(){var e=V(["name","personId"]),t=Object(o.a)(e,2),n=t[0],a=t[1];return[Object(r.useMemo)((function(){return Object(b.a)(Object(b.a)({},n),{},{personId:Number(n.personId)||void 0})}),[n]),a]},se=function(){var e=ue(),t=Object(o.a)(e,1)[0];return["projects",h(t)]},de=n(65),le=n(79),je=n(91),be=n(92),fe=function(e){Object(je.a)(n,e);var t=Object(be.a)(n);function n(){var e;Object(de.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={error:null},e}return Object(le.a)(n,[{key:"render",value:function(){var e=this.state.error,t=this.props,n=t.fallbackRender,r=t.children;return e?n({error:e}):r}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(r.Component),pe=n(22),Oe=n(70),me=["title","titleId"];function he(){return(he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ve(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function xe(e,t){var n=e.title,a=e.titleId,c=ve(e,me);return r.createElement("svg",he({viewBox:"0 0 179 32",xmlns:"http://www.w3.org/2000/svg",focusable:"false","aria-hidden":"true",className:"css-sq9aeg-Logo",ref:t,"aria-labelledby":a},c),n?r.createElement("title",{id:a},n):null,X||(X=r.createElement("defs",null,r.createElement("linearGradient",{x1:"97.6553341%",y1:"35.6591143%",x2:"37.202032%",y2:"75.4891864%",id:"uid392-1"},r.createElement("stop",{stopColor:"#0052CC",offset:"7%"}),r.createElement("stop",{stopColor:"#2684FF",offset:"100%"})),r.createElement("linearGradient",{x1:"8.43371138%",y1:"60.1495759%",x2:"64.1161517%",y2:"23.5790285%",id:"uid392-2"},r.createElement("stop",{stopColor:"#0052CC",offset:"0%"}),r.createElement("stop",{stopColor:"#2684FF",offset:"100%"})))),$||($=r.createElement("g",{stroke:"none",strokeWidth:1,fillRule:"nonzero"},r.createElement("path",{d:"M11.3881081,27.9242105 C12.4881804,26.8071817 13.1062496,25.2917664 13.1062496,23.7115789 C13.1062496,22.1313915 12.4881804,20.6159762 11.3881081,19.4989474 L11.3881081,19.4989474 L3.74837838,11.7621053 L0.273513514,15.2926316 C-0.0900771727,15.6625064 -0.0900771727,16.2617042 0.273513514,16.6315789 L11.3881081,27.9242105 L11.3881081,27.9242105 Z",fill:"currentColor",fillRule:"nonzero"}),r.createElement("path",{d:"M22.5027027,15.2926316 L11.3881081,4 L11.3881081,4 L11.3539189,4.03473684 L11.3539189,4.03473684 C9.08852466,6.36456187 9.09963243,10.1156459 11.3787838,12.4315789 L19.0247297,20.1652632 L22.5027027,16.6315789 C22.8662934,16.2617042 22.8662934,15.6625064 22.5027027,15.2926316 Z",fill:"currentColor",fillRule:"nonzero"}),r.createElement("path",{d:"M11.3881081,12.4252632 C9.10895676,10.1093301 9.09784899,6.35824608 11.3632432,4.02842105 L3.43445946,12.0810526 L7.58067568,16.2936842 L11.3881081,12.4252632 Z",fill:"url(#uid392-1)",fillRule:"nonzero"}),r.createElement("path",{d:"M15.1893243,15.6368421 L11.3881081,19.4989474 C12.4881804,20.6159762 13.1062496,22.1313915 13.1062496,23.7115789 C13.1062496,25.2917664 12.4881804,26.8071817 11.3881081,27.9242105 L19.3355405,19.8494737 L15.1893243,15.6368421 Z",fill:"url(#uid392-2)",fillRule:"nonzero"}),r.createElement("path",{d:"M36.07,18.956 C36.07,20.646 35.394,21.842 33.418,21.842 C32.56,21.842 31.702,21.686 31,21.4 L31,23.662 C31.65,23.896 32.586,24.104 33.808,24.104 C37.032,24.104 38.41,21.946 38.41,18.8 L38.41,6.918 L36.07,6.918 L36.07,18.956 Z M41.894,7.568 C41.894,8.556 42.544,9.128 43.454,9.128 C44.364,9.128 45.014,8.556 45.014,7.568 C45.014,6.58 44.364,6.008 43.454,6.008 C42.544,6.008 41.894,6.58 41.894,7.568 Z M42.31,24 L44.546,24 L44.546,11 L42.31,11 L42.31,24 Z M47.926,24 L50.11,24 L50.11,16.33 C50.11,13.574 51.852,12.716 54.712,13.002 L54.712,10.818 C52.164,10.662 50.864,11.754 50.11,13.288 L50.11,11 L47.926,11 L47.926,24 Z M65.45,24 L65.45,21.66 C64.618,23.376 63.058,24.26 61.056,24.26 C57.598,24.26 55.856,21.322 55.856,17.5 C55.856,13.834 57.676,10.74 61.316,10.74 C63.214,10.74 64.67,11.598 65.45,13.288 L65.45,11 L67.686,11 L67.686,24 L65.45,24 Z M58.092,17.5 C58.092,20.62 59.34,22.18 61.654,22.18 C63.656,22.18 65.45,20.906 65.45,18.02 L65.45,16.98 C65.45,14.094 63.812,12.82 61.914,12.82 C59.392,12.82 58.092,14.484 58.092,17.5 Z M86.926,19.294 C86.926,16.226 84.898,15.056 81.284,14.146 C78.268,13.392 77.176,12.69 77.176,11.286 C77.176,9.726 78.502,8.946 80.738,8.946 C82.506,8.946 84.352,9.258 86.068,10.246 L86.068,7.906 C84.898,7.256 83.312,6.658 80.842,6.658 C76.864,6.658 74.836,8.634 74.836,11.286 C74.836,14.094 76.552,15.42 80.4,16.356 C83.65,17.136 84.586,17.942 84.586,19.45 C84.586,20.958 83.624,21.972 81.05,21.972 C78.788,21.972 76.344,21.374 74.758,20.542 L74.758,22.934 C76.084,23.61 77.618,24.26 80.92,24.26 C85.158,24.26 86.926,22.258 86.926,19.294 Z M95.09,24.26 C91.19,24.26 88.902,21.374 88.902,17.474 C88.902,13.574 91.19,10.74 95.09,10.74 C98.964,10.74 101.226,13.574 101.226,17.474 C101.226,21.374 98.964,24.26 95.09,24.26 Z M95.09,12.82 C92.308,12.82 91.086,15.004 91.086,17.474 C91.086,19.944 92.308,22.18 95.09,22.18 C97.846,22.18 99.042,19.944 99.042,17.474 C99.042,15.004 97.846,12.82 95.09,12.82 Z M106.92,9.622 C106.92,8.452 107.596,7.646 108.974,7.646 C109.494,7.646 109.988,7.698 110.378,7.776 L110.378,5.722 C109.988,5.618 109.546,5.514 108.87,5.514 C106.088,5.514 104.736,7.152 104.736,9.57 L104.736,11 L102.63,11 L102.63,13.08 L104.736,13.08 L104.736,24 L106.92,24 L106.92,13.08 L110.274,13.08 L110.274,11 L106.92,11 L106.92,9.622 Z M115.786,19.892 L115.786,13.08 L119.244,13.08 L119.244,11 L115.786,11 L115.786,8.244 L113.602,8.244 L113.602,11 L111.496,11 L111.496,13.08 L113.602,13.08 L113.602,19.944 C113.602,22.362 114.954,24 117.736,24 C118.412,24 118.854,23.896 119.244,23.792 L119.244,21.634 C118.854,21.712 118.36,21.816 117.84,21.816 C116.462,21.816 115.786,21.036 115.786,19.892 Z M125.432,24 L128.292,24 L130.528,17.708 L131.724,13.704 L132.92,17.708 L135.156,24 L138.016,24 L142.8,11 L140.33,11 L136.586,22.024 L132.79,11 L130.658,11 L126.862,22.024 L123.118,11 L120.648,11 L125.432,24 Z M153.538,24 L153.538,21.66 C152.706,23.376 151.146,24.26 149.144,24.26 C145.686,24.26 143.944,21.322 143.944,17.5 C143.944,13.834 145.764,10.74 149.404,10.74 C151.302,10.74 152.758,11.598 153.538,13.288 L153.538,11 L155.774,11 L155.774,24 L153.538,24 Z M146.18,17.5 C146.18,20.62 147.428,22.18 149.742,22.18 C151.744,22.18 153.538,20.906 153.538,18.02 L153.538,16.98 C153.538,14.094 151.9,12.82 150.002,12.82 C147.48,12.82 146.18,14.484 146.18,17.5 Z M159.154,24 L161.338,24 L161.338,16.33 C161.338,13.574 163.08,12.716 165.94,13.002 L165.94,10.818 C163.392,10.662 162.092,11.754 161.338,13.288 L161.338,11 L159.154,11 L159.154,24 Z M178.108,23.48 C177.042,24.052 175.404,24.26 174.078,24.26 C169.216,24.26 167.084,21.452 167.084,17.474 C167.084,13.548 169.268,10.74 173.22,10.74 C177.224,10.74 178.836,13.522 178.836,17.474 L178.836,18.488 L169.346,18.488 C169.658,20.698 171.088,22.128 174.156,22.128 C175.664,22.128 176.938,21.842 178.108,21.426 L178.108,23.48 Z M173.116,12.768 C170.75,12.768 169.554,14.302 169.32,16.564 L176.574,16.564 C176.444,14.146 175.352,12.768 173.116,12.768 Z",fill:"inherit",fillRule:"evenodd"}))))}var ge,ye,we,Ie,ke,Ce,Le,Ee,_e=r.forwardRef(xe),Te=(n.p,Object(L.a)(Oe.a)(ge||(ge=Object(C.a)(["\n  padding: 0;\n"])))),Me=L.a.div(ye||(ye=Object(C.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: ",";\n  width: ",";\n  flex-wrap: wrap;\n  > * {\n    margin-top: 0;\n    margin-bottom: 0;\n    margin-right: ",";\n  }\n"])),(function(e){return e.between?"space-between":void 0}),(function(e){return e.width}),(function(e){return void 0!==e.gap?e.gap+"rem":"2rem"})),Se=L.a.header(we||(we=Object(C.a)(["\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 2rem;\n  padding: 1.6rem 2.4rem;\n  box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.1);\n\n  .ant-btn {\n    margin-right: 0;\n  }\n"]))),Ne=Object(L.a)(Me)(Ie||(Ie=Object(C.a)(["\n  display: flex;\n"]))),Pe=L.a.h3(ke||(ke=Object(C.a)(["\n  color: ",";\n\n  @media (max-width: 525px) {\n    display: ",";\n  }\n"])),(function(e){return"primary"===e.type&&"var(--color-primary)"}),(function(e){return e.mobileHidden&&"none"})),De=L.a.div(Ce||(Ce=Object(C.a)(["\n  cursor: pointer;\n\n  div {\n    display: flex;\n    align-items: center;\n    width: 16rem;\n    color: rgb(38, 132, 255);\n    cursor: pointer;\n  }\n\n  @media (max-width: 525px) {\n    width: 2.5rem;\n    overflow-y: hidden;\n  }\n"]))),Fe=Object(L.a)(Me)(Le||(Le=Object(C.a)([""]))),Qe=L.a.div(Ee||(Ee=Object(C.a)(["\n  min-width: 30rem;\n\n  @media (max-width: 525px) {\n    min-width: 28rem;\n  }\n"]))),qe=n(504),Re=n(505),Ae=function(){var e=te().open,t=U().data,n=null===t||void 0===t?void 0:t.filter((function(e){return e.pin})),r=Object(_.jsxs)(Qe,{children:[Object(_.jsx)(M.a.Text,{type:"secondary",children:"\u6536\u85cf\u9805\u76ee"}),Object(_.jsx)(qe.b,{children:null===n||void 0===n?void 0:n.map((function(e){return Object(_.jsx)(qe.b.Item,{children:Object(_.jsx)(qe.b.Item.Meta,{title:e.name})},e.id)}))}),Object(_.jsx)(Te,{onClick:e,type:"link",children:"\u5275\u5efa\u9805\u76ee"})]});return Object(_.jsx)(Re.a,{placement:"bottom",content:r,children:Object(_.jsx)("h3",{children:"\u9805\u76ee"})})};function ze(){var e=q();return Object(P.useQuery)(["users"],(function(){return e("users")}))}var Be,Ze,He=function(){var e=ze().data,t=Object(_.jsxs)(Qe,{children:[Object(_.jsx)(M.a.Text,{type:"secondary",children:"\u7d44\u54e1\u5217\u8868"}),Object(_.jsx)(qe.b,{children:null===e||void 0===e?void 0:e.map((function(e){return Object(_.jsx)(qe.b.Item,{children:Object(_.jsx)(qe.b.Item.Meta,{title:e.name})},e.id)}))})]});return Object(_.jsx)(Re.a,{placement:"bottom",content:t,children:Object(_.jsx)("h3",{children:"\u7d44\u54e1"})})},Je=function(e){return Object(_.jsx)(J.b,{to:"/",children:Object(_.jsx)(De,{children:Object(_.jsx)("div",{children:Object(_.jsx)(_e,{})})})})},Ke=function(){var e=Q(),t=e.logout,n=e.user;return Object(_.jsxs)(Se,{children:[Object(_.jsxs)(Ne,{children:[Object(_.jsx)(Je,{}),Object(_.jsx)(Ae,{}),Object(_.jsx)(He,{})]}),Object(_.jsxs)(Fe,{gap:1,children:[Object(_.jsxs)(Pe,{type:"primary",mobileHidden:!0,children:["Hi, ",null===n||void 0===n?void 0:n.name]}),Object(_.jsx)(Oe.a,{type:"primary",onClick:t,children:"\u767b\u51fa"})]})]})},Ve=n(503),We=n(499),Ue=n(501),Ye=n(157),Ge=["value","onChange","defaultOptionName","options"],Xe=function(e){return isNaN(Number(e))?0:Number(e)},$e=function(e){var t=e.value,n=e.onChange,r=e.defaultOptionName,a=e.options,c=Object(f.a)(e,Ge);return Object(_.jsxs)(Ye.a,Object(b.a)(Object(b.a)({},c),{},{value:(null===a||void 0===a?void 0:a.length)?Xe(t):0,onChange:function(e){return null===n||void 0===n?void 0:n(Xe(e)||void 0)},children:[r?Object(_.jsx)(Ye.a.Option,{value:0,children:r}):null,null===a||void 0===a?void 0:a.map((function(e){return Object(_.jsx)(Ye.a.Option,{value:e.id,children:e.name},e.id)}))]}))},et=function(e){var t=Object.assign({},e),n=ze().data;return Object(_.jsx)($e,Object(b.a)({options:n||[]},t))},tt=n(203),nt=L.a.div(Be||(Be=Object(C.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 80vh;\n  justify-content: center;\n  align-items: center;\n\n  .ant-form {\n    max-width: 40rem;\n    width: 100%;\n  }\n\n  .modal-button {\n    .ant-form-item-control-input-content {\n      text-align: end;\n    }\n  }\n"]))),rt=function(){var e=te(),t=e.projectModalOpen,n=e.close,a=e.editingProject,c=e.isLoading,i=a?"\u7de8\u8f2f\u9805\u76ee":"\u5275\u5efa\u9805\u76ee",u=(a?Y:G)(se()),s=u.mutateAsync,d=u.error,l=u.isLoading,j=Object(tt.useForm)(),f=Object(o.a)(j,1)[0];return Object(r.useEffect)((function(){f.setFieldsValue(a)}),[a,f]),Object(_.jsxs)(Ve.a,{forceRender:!0,onClose:function(){f.resetFields(),n()},visible:t,width:"100%",children:[Object(_.jsx)("h2",{children:i}),Object(_.jsx)(S,{error:d}),Object(_.jsx)(nt,{children:c?Object(_.jsx)(k.a,{size:"large"}):Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)(We.a,{form:f,layout:"vertical",onFinish:function(e){s(Object(b.a)(Object(b.a)({},a),e)).then((function(){f.resetFields(),n()}))},children:[Object(_.jsx)(We.a.Item,{label:"\u540d\u7a31",name:"name",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u9805\u76ee\u540d\u7a31"}],children:Object(_.jsx)(Ue.a,{placeholder:"\u8acb\u8f38\u5165\u9805\u76ee\u540d\u7a31"})}),Object(_.jsx)(We.a.Item,{label:"\u5099\u8a3b",name:"organization",children:Object(_.jsx)(Ue.a,{placeholder:"\u8acb\u8f38\u5165\u5099\u8a3b"})}),Object(_.jsx)(We.a.Item,{label:"\u8ca0\u8cac\u4eba",name:"personId",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u8ca0\u8cac\u4eba\u540d\u7a31"}],children:Object(_.jsx)(et,{defaultOptionName:"\u8ca0\u8cac\u4eba"})}),Object(_.jsx)(We.a.Item,{className:"modal-button",children:Object(_.jsx)(Oe.a,{loading:l,type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})})})]})},at=n(495),ct=Object(L.a)(We.a)(Ze||(Ze=Object(C.a)(["\n  /* margin-bottom: 1.2rem; */\n  .ant-form-item {\n    min-width: 120px;\n  }\n\n  @media (max-width: 767px) {\n    flex-direction: column;\n\n    .ant-form-item {\n      margin-right: 0;\n      margin-bottom: 1.2rem;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n    }\n  }\n"]))),it=function(e){var t=e.param,n=e.setParam;return Object(_.jsxs)(ct,{layout:"inline",children:[Object(_.jsx)(We.a.Item,{children:Object(_.jsx)(Ue.a,{type:"text",value:t.name,placeholder:"\u67e5\u627e\u540d\u7a31",onChange:function(e){n(Object(b.a)(Object(b.a)({},t),{},{name:e.target.value}))}})}),Object(_.jsx)(We.a.Item,{children:Object(_.jsx)(et,{defaultOptionName:"\u8ca0\u8cac\u4eba",value:t.personId,onChange:function(e){return n(Object(b.a)(Object(b.a)({},t),{},{personId:e}))}})})]})},ot=n(496),ut=n(284),st=n.n(ut);function dt(e){return st()(e).format("YYYY-MM-DD HH:mm:ss")}var lt,jt=n(502),bt=["checked","onCheckChange"],ft=function(e){var t=e.checked,n=e.onCheckChange,r=Object(f.a)(e,bt);return Object(_.jsx)(jt.a,Object(b.a)({count:1,value:t?1:0,onChange:function(e){return null===n||void 0===n?void 0:n(!!e)}},r))},pt=n(500),Ot=n(206),mt=n(122),ht=n(506),vt=function(e){var t=e.handleEdit,n=e.handleDelete;return Object(_.jsx)(Ot.a,{overlay:Object(_.jsxs)(mt.a,{children:[Object(_.jsx)(mt.a.Item,{onClick:function(){return t()},children:Object(_.jsx)(Oe.a,{type:"link",children:"\u7de8\u8f2f"})},"edit"),Object(_.jsx)(mt.a.Item,{onClick:function(){pt.a.confirm({title:"\u78ba\u5b9a\u522a\u9664\u9019\u500b\u9805\u76ee\u55ce\uff1f",content:"\u9ede\u64ca\u78ba\u5b9a\u522a\u9664",okText:"\u78ba\u5b9a",onOk:function(){n()}})},children:Object(_.jsx)(Oe.a,{type:"link",children:"\u522a\u9664"})},"remove")]}),children:Object(_.jsx)(ht.a,{})})},xt=["users"],gt=function(e){var t=e.users,n=Object(f.a)(e,xt),r=Y(se()).mutate,a=te().startEdit,c=function(e){var t=q();return Object(P.useMutation)((function(e){var n=e.id;return t("projects/".concat(n),{method:"DELETE"})}),ie(e))}(se()).mutate,i=[{title:Object(_.jsx)(ft,{checked:!0,disabled:!0}),render:function(e,t){return Object(_.jsx)(ft,{checked:t.pin,onCheckChange:(n=t.id,function(e){return r({id:n,pin:e})})});var n},width:50},{title:"\u540d\u7a31",sorter:function(e,t){return e.name.localeCompare(t.name)},render:function(e,t){var n;return Object(_.jsx)(J.b,{to:null===(n=t.id)||void 0===n?void 0:n.toString(),children:t.name})},width:180},{title:"\u8ca0\u8cac\u4eba",render:function(e,n){var r;return Object(_.jsx)("span",{children:(null===(r=t.find((function(e){return e.id===n.personId})))||void 0===r?void 0:r.name)||"\u672a\u77e5"},n.id)},width:100},{title:"\u5275\u5efa\u6642\u9593",render:function(e,t){return Object(_.jsx)("span",{children:t.created?dt(t.created):"\u7121"},t.id)},width:200},{title:"\u64cd\u4f5c",render:function(e,t){return Object(_.jsx)(vt,{handleEdit:function(){return e=t.id,a(e);var e},handleDelete:function(){return c({id:t.id})}})},width:80}];return Object(_.jsx)(ot.a,Object(b.a)({scroll:{x:"100%"},pagination:!1,rowKey:"id",columns:i,tableLayout:"fixed"},n))},yt=L.a.div(lt||(lt=Object(C.a)(["\n  .top {\n    display: flex;\n    justify-content: space-between;\n  }\n"]))),wt=function(){var e=ue(),t=Object(o.a)(e,2),n=t[0],r=t[1],a=U(s(n,200)),c=a.isLoading,i=a.error,u=a.data,d=ze().data,l=te().open;return Object(_.jsxs)(yt,{children:[Object(_.jsxs)("div",{className:"top",children:[Object(_.jsx)("h2",{children:"\u9805\u76ee\u5217\u8868"}),Object(_.jsx)(Oe.a,{onClick:l,children:"\u5275\u5efa\u9805\u76ee"})]}),Object(_.jsx)(it,{param:n,setParam:r}),Object(_.jsx)(at.a,{}),Object(_.jsx)(S,{error:i}),Object(_.jsx)(gt,{loading:c,dataSource:u||[],users:d||[]})]})};wt.whyDidYouRender=!1;var It=wt,kt=n(169),Ct=n(156);function Lt(e){var t=q();return Object(P.useQuery)(["kanbans",e],(function(){return t("kanbans",{data:e})}))}var Et=function(e){var t=q();return Object(P.useMutation)((function(e){return t("kanbans/reorder",{data:e,method:"POST"})}),function(e){return ce(e,(function(e,t){return ne(Object(b.a)({list:t},e))}))}(e))};function _t(e){var t=q();return Object(P.useQuery)(["tasks",e],(function(){return t("tasks",{data:e})}))}var Tt=function(e){var t=q();return Object(P.useMutation)((function(e){return t("tasks/reorder",{data:e,method:"POST"})}),function(e){return ce(e,(function(e,t){return ne(Object(b.a)({list:t},e)).map((function(t){return t.id===e.fromId?Object(b.a)(Object(b.a)({},t),{},{kanbanId:e.toKanbanId}):t}))}))}(e))},Mt=["children"],St=["children"],Nt=["children"],Pt=function(e){var t=e.children,n=Object(f.a)(e,Mt);return Object(_.jsx)(Ct.c,Object(b.a)(Object(b.a)({},n),{},{children:function(e){return a.a.isValidElement(t)?a.a.cloneElement(t,Object(b.a)(Object(b.a)({},e.droppableProps),{},{ref:e.innerRef,provided:e})):Object(_.jsx)("div",{})}}))},Dt=a.a.forwardRef((function(e,t){var n,r=e.children,a=Object(f.a)(e,St);return Object(_.jsxs)("div",Object(b.a)(Object(b.a)({ref:t},a),{},{children:[r,null===(n=a.provided)||void 0===n?void 0:n.placeholder]}))})),Ft=function(e){var t=e.children,n=Object(f.a)(e,Nt);return Object(_.jsx)(Ct.b,Object(b.a)(Object(b.a)({},n),{},{children:function(e){return a.a.isValidElement(t)?a.a.cloneElement(t,Object(b.a)(Object(b.a)(Object(b.a)({},e.draggableProps),e.dragHandleProps),{},{ref:e.innerRef})):Object(_.jsx)("div",{})}}))},Qt=function(){var e,t=null===(e=Object(pe.f)().pathname.match(/project\/(\d+)/))||void 0===e?void 0:e[1];return Number(t)},qt=function(){return[{projectId:Qt()}]},Rt=function(){var e=qt();return["kanbans",Object(o.a)(e,1)[0]]},At=function(){var e=V(["name","typeId","processorId","tagId"]),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Qt();return[Object(r.useMemo)((function(){return{projectId:c,typeId:Number(n.typeId)||void 0,processorId:Number(n.processorId)||void 0,tagId:Number(n.tagId)||void 0,name:n.name}}),[c,n]),a]},zt=function(){var e=At();return["tasks",Object(o.a)(e,1)[0]]},Bt=function(){var e=V(["editingTaskId"]),t=Object(o.a)(e,2),n=t[0].editingTaskId,a=t[1],c=function(e){var t=q();return Object(P.useQuery)(["task",{id:e}],(function(){return t("tasks/".concat(e))}),{enabled:!!e})}(Number(n)),i=c.data,u=c.isLoading;return{editingTaskId:n,editingTask:i,startEdit:Object(r.useCallback)((function(e){a({editingTaskId:e})}),[a]),close:Object(r.useCallback)((function(){a({editingTaskId:""})}),[a]),isLoading:u}},Zt=n(497),Ht=function(e){var t=e.kanbanId,n=Object(r.useState)(""),a=Object(o.a)(n,2),c=a[0],i=a[1],u=Object(r.useState)(!1),s=Object(o.a)(u,2),d=s[0],b=s[1],f=function(e){var t=q(),n=Object(P.useQueryClient)();return Object(P.useMutation)((function(e){return t("tasks",{data:e,method:"POST"})}),{onSuccess:function(t){var r=n.getQueryData(e)||[];n.setQueryData(e,[].concat(Object(W.a)(r),[t]))}})}(zt()).mutateAsync,p=Qt(),O=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f({projectId:p,name:c,kanbanId:t});case 2:b(!1),i("");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){return b((function(e){return!e}))};return Object(r.useEffect)((function(){d||i("")}),[d]),d?Object(_.jsx)(Zt.a,{children:Object(_.jsx)(Ue.a,{onBlur:m,placeholder:"\u9700\u8981\u505a\u4e9b\u4ec0\u9ebc",autoFocus:!0,value:c,onPressEnter:O,onChange:function(e){return i(e.target.value)}})}):Object(_.jsx)("div",{style:{padding:"0.6rem",cursor:"pointer"},onClick:m,children:"+ \u5275\u5efa\u4efb\u52d9"})};function Jt(e){var t=q();return Object(P.useQuery)(["taskTypes",e],(function(){return t("taskTypes",{data:e})}))}var Kt,Vt,Wt,Ut,Yt,Gt,Xt=n.p+"static/media/bug.bc7dca9d.svg",$t=n.p+"static/media/task.8118694e.svg",en=function(e){var t=e.name,n=e.keyword;if(!n)return Object(_.jsx)(_.Fragment,{children:t});var r=t.split(n);return Object(_.jsx)(_.Fragment,{children:r.map((function(e,t){return Object(_.jsxs)("span",{children:[e,t===r.length-1?null:Object(_.jsx)("span",{style:{color:"#257afd"},children:n})]},t)}))})},tn=L.a.div(Kt||(Kt=Object(C.a)(["\n  min-width: 27rem;\n  border-radius: 6px;\n  background-color: rgb(244, 245, 247);\n  display: flex;\n  flex-direction: column;\n  padding: 0.8rem 0.8rem 1rem;\n  margin-right: 1.5rem;\n  /* min-height: 100%; */\n  min-height: 18rem;\n\n  .title {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 6px;\n  }\n"]))),nn=L.a.div(Vt||(Vt=Object(C.a)(["\n  /* overflow-y: scroll; */\n  /* height: 600px; */\n  /* min-height: 300px; */\n  :last-child {\n    margin-right: 0;\n  }\n"]))),rn=Object(L.a)(Dt)(Wt||(Wt=Object(C.a)(["\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  /* min-height: 10rem; */\n"]))),an=L.a.div(Ut||(Ut=Object(C.a)(["\n  margin-bottom: 0.5rem;\n  cursor: pointer;\n  background-color: #fff;\n  padding: 1.6rem 1rem;\n  /* min-height: 10rem; */\n\n  .bottom {\n    display: flex;\n    justify-content: space-between;\n  }\n"]))),cn=["task","startEdit"],on=function(e){var t,n=e.id,r=Jt().data,a=null===r||void 0===r||null===(t=r.find((function(e){return e.id===n})))||void 0===t?void 0:t.name;return a?Object(_.jsx)("img",{src:"task"===a?$t:Xt,alt:"icon"}):null},un=Object(r.forwardRef)((function(e,t){var n=e.task,a=e.startEdit,c=Object(f.a)(e,cn),i=At(),u=Object(o.a)(i,1)[0],s=function(e){var t=q();return Object(P.useMutation)((function(e){var n=e.id;return t("tasks/".concat(n),{method:"DELETE"})}),ie(e))}(zt()).mutate,d=u.name;return Object(r.createElement)(an,Object(b.a)(Object(b.a)({},c),{},{ref:t,key:n.id,onClick:function(){return a(n.id)}}),Object(_.jsx)("p",{children:Object(_.jsx)(en,{keyword:d,name:n.name})}),Object(_.jsxs)("div",{className:"bottom",children:[Object(_.jsx)(on,{id:n.typeId}),Object(_.jsx)(Oe.a,{onClick:function(e){e.stopPropagation(),pt.a.confirm({okText:"\u78ba\u5b9a",cancelText:"\u53d6\u6d88",title:"\u78ba\u5b9a\u8981\u522a\u9664\u4efb\u52d9\u55ce\uff1f",onOk:function(){s({id:n.id})}})},size:"small",type:"primary",children:"\u522a\u9664"})]}))})),sn=function(e){var t=e.kanban,n=function(e){var t=q();return Object(P.useMutation)((function(e){var n=e.id;return t("kanbans/".concat(n),{method:"DELETE"})}),ie(e))}(Rt()).mutate,r=Object(_.jsx)(mt.a,{children:Object(_.jsx)(mt.a.Item,{onClick:function(){pt.a.confirm({okText:"\u78ba\u5b9a",cancelText:"\u53d6\u6d88",title:"\u78ba\u5b9a\u8981\u522a\u9664\u770b\u7248\u55ce\uff1f",onOk:function(){n({id:t.id})}})},children:Object(_.jsx)(Oe.a,{type:"link",children:"\u522a\u9664"})},"remove")});return Object(_.jsx)(Ot.a,{overlay:r,placement:"bottomRight",arrow:!0,children:Object(_.jsx)(ht.a,{})})},dn=["kanban","children"],ln=Object(r.forwardRef)((function(e,t){var n=e.kanban,r=(e.children,Object(f.a)(e,dn)),a=At(),c=_t(Object(o.a)(a,1)[0]).data,i=null===c||void 0===c?void 0:c.filter((function(e){return e.kanbanId===n.id})),u=Bt().startEdit,s=function(e){return{draggableProps:{style:null===e||void 0===e?void 0:e.style,"data-rbd-draggable-context-id":null===e||void 0===e?void 0:e["data-rbd-draggable-context-id"],"data-rbd-draggable-id":null===e||void 0===e?void 0:e["data-rbd-draggable-id"],onTransitionEnd:null===e||void 0===e?void 0:e.onTransitionEnd},dragHandleProps:{"data-rbd-drag-handle-draggable-id":null===e||void 0===e?void 0:e["data-rbd-drag-handle-draggable-id"],"data-rbd-drag-handle-context-id":null===e||void 0===e?void 0:e["data-rbd-drag-handle-context-id"],"aria-describedby":null===e||void 0===e?void 0:e["aria-describedby"],role:null===e||void 0===e?void 0:e.role,tabIndex:null===e||void 0===e?void 0:e.tabIndex,draggable:null===e||void 0===e?void 0:e.draggable,onDragStart:null===e||void 0===e?void 0:e.onDragStart}}}(r);return Object(_.jsx)("div",Object(b.a)(Object(b.a)({ref:t},s.draggableProps),{},{children:Object(_.jsxs)(tn,{children:[Object(_.jsxs)("div",Object(b.a)(Object(b.a)({className:"title"},s.dragHandleProps),{},{children:[Object(_.jsx)("h3",{children:n.name}),Object(_.jsx)(sn,{kanban:n})]})),Object(_.jsx)(Ht,{kanbanId:n.id}),Object(_.jsx)(Pt,{type:"ROW",direction:"vertical",droppableId:n.id.toString(),children:Object(_.jsx)(rn,{children:Object(_.jsx)(nn,{children:null===i||void 0===i?void 0:i.map((function(e,t){return Object(_.jsx)(Ft,{index:t,draggableId:"task"+e.id,children:Object(_.jsx)(un,{startEdit:u,task:e})},e.id)}))})})})]})}))})),jn=function(e){var t=Object.assign({},e),n=Jt().data;return Object(_.jsx)($e,Object(b.a)({options:n||[]},t))},bn=function(e){var t=At(),n=Object(o.a)(t,2),a=n[0],c=n[1],i=We.a.useForm(),u=Object(o.a)(i,1)[0],d=Object(r.useState)(a.name||""),l=Object(o.a)(d,2),j=l[0],b=l[1],f=s(j,300);return Object(r.useEffect)((function(){c({name:f})}),[f,c]),Object(_.jsxs)(ct,{layout:"inline",form:u,children:[Object(_.jsx)(We.a.Item,{children:Object(_.jsx)(Ue.a,{type:"text",value:j,placeholder:"\u8acb\u8f38\u5165\u4efb\u52d9\u540d...",onChange:function(e){return b(e.target.value)}})}),Object(_.jsx)(We.a.Item,{children:Object(_.jsx)(et,{defaultOptionName:"\u8ca0\u8cac\u4eba",value:a.processorId,onChange:function(e){return c({processorId:e})}})}),Object(_.jsx)(We.a.Item,{children:Object(_.jsx)(jn,{defaultOptionName:"\u985e\u578b",value:a.typeId,onChange:function(e){return c({typeId:e})}})}),Object(_.jsx)(We.a.Item,{children:Object(_.jsx)(Oe.a,{onClick:function(){c({typeId:void 0,processorId:void 0,tagId:void 0,name:void 0})},children:"\u6e05\u9664\u7be9\u9078\u5668"})})]})},fn=function(e){var t=Object(r.useState)(""),n=Object(o.a)(t,2),a=n[0],c=n[1],i=Qt(),u=function(e){var t=q(),n=Object(P.useQueryClient)();return Object(P.useMutation)((function(e){return t("kanbans",{data:e,method:"POST"})}),{onSuccess:function(t){var r=n.getQueryData(e);n.setQueryData(e,[].concat(Object(W.a)(r),[t]))}})}(Rt()).mutateAsync,s=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({name:a,projectId:i});case 2:c("");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(_.jsx)(tn,{children:Object(_.jsx)(Ue.a,{size:"large",placeholder:"\u65b0\u5efa\u770b\u677f\u540d\u7a31",onPressEnter:s,value:a,onChange:function(e){return c(e.target.value)}})})},pn=Object(L.a)(Dt)(Yt||(Yt=Object(C.a)(["\n  display: inline-flex;\n  flex: 1;\n  overflow: auto;\n"]))),On=L.a.div(Gt||(Gt=Object(C.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n"]))),mn={labelCol:{span:4},wrapperCol:{span:20}},hn=function(e){var t=We.a.useForm(),n=Object(o.a)(t,1)[0],a=Bt(),c=a.editingTask,i=a.editingTaskId,u=a.close,s=a.isLoading,d=function(e){var t=q();return Object(P.useMutation)((function(e){return t("tasks/".concat(e.id),{data:e,method:"PATCH"})}),oe(e))}(zt()).mutate,f=Object(P.useQueryClient)(),p=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(b.a)(Object(b.a)({},c),n.getFieldsValue()),d(t),f.setQueryData(["task",{id:Number(i)}],t),u();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){n.setFieldsValue(c)}),[n,c]),Object(_.jsx)(pt.a,{okText:"\u78ba\u8a8d",cancelText:"\u53d6\u6d88",onCancel:function(){u(),n.resetFields()},onOk:p,title:"\u7de8\u8f2f",visible:!!i,forceRender:!0,children:s?Object(_.jsx)(k.a,{style:{margin:"3rem auto",width:"100%"}}):Object(_.jsxs)(We.a,Object(b.a)(Object(b.a)({},mn),{},{initialValues:c,form:n,children:[Object(_.jsx)(We.a.Item,{label:"\u4efb\u52d9\u540d",name:"name",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u4efb\u52d9\u540d"}],children:Object(_.jsx)(Ue.a,{})}),Object(_.jsx)(We.a.Item,{label:"\u8ca0\u8cac\u4eba",name:"processorId",children:Object(_.jsx)(et,{defaultOptionName:"\u8ca0\u8cac\u4eba"})}),Object(_.jsx)(We.a.Item,{label:"\u985e\u578b",name:"typeId",children:Object(_.jsx)(jn,{})})]}))})},vn=function(e){Z("\u770b\u677f\u5217\u8868");var t=ee(Qt()).data,n=qt(),a=Lt(Object(o.a)(n,1)[0]),c=a.data,i=a.isLoading,u=At(),s=_t(Object(o.a)(u,1)[0]).isLoading||i,d=function(){var e=qt(),t=Object(o.a)(e,1)[0],n=At(),a=Object(o.a)(n,1)[0],c=Lt(t).data,i=Et(Rt()).mutate,u=_t(a).data,s=void 0===u?[]:u,d=Tt(zt()).mutate;return Object(r.useCallback)((function(e){var t=e.source,n=e.destination,r=e.type;if(n){if("COLUMN"===r){var a=null===c||void 0===c?void 0:c[t.index].id,o=null===c||void 0===c?void 0:c[n.index].id;if(!a||!o||a===o)return;var u=n.index>t.index?"after":"before";i({fromId:a,referenceId:o,type:u})}if("ROW"===r){var l=+t.droppableId,j=+n.droppableId,b=s.filter((function(e){return e.kanbanId===l}))[t.index],f=s.filter((function(e){return e.kanbanId===j}))[n.index];if((null===b||void 0===b?void 0:b.id)===(null===f||void 0===f?void 0:f.id))return;console.log(b),d({fromId:null===b||void 0===b?void 0:b.id,referenceId:null===f||void 0===f?void 0:f.id,fromKanbanId:l,toKanbanId:j,type:l===j&&n.index>t.index?"after":"before"})}}}),[c,i,s,d])}();return Object(_.jsxs)(On,{children:[Object(_.jsxs)("h2",{children:[null===t||void 0===t?void 0:t.name,"\u770b\u677f"]}),Object(_.jsx)(bn,{}),Object(_.jsx)(at.a,{}),s?Object(_.jsx)(k.a,{style:{margin:"3rem 0"}}):Object(_.jsxs)(pn,{children:[Object(_.jsx)(Ct.a,{onDragEnd:d,children:Object(_.jsx)(Pt,{type:"COLUMN",direction:"horizontal",droppableId:"kanban",children:Object(_.jsx)(Dt,{style:{display:"flex"},children:null===c||void 0===c?void 0:c.map((function(e,t){return Object(_.jsx)(Ft,{draggableId:"kaban"+e.id,index:t,children:Object(_.jsx)(ln,{kanban:e})},e.id)}))})})}),Object(_.jsx)("div",{children:Object(_.jsx)(fn,{})})]}),Object(_.jsx)(hn,{})]})};function xn(e){var t=q(),n=Object(P.useQueryClient)();return Object(P.useMutation)((function(e){return t("epics",{data:e,method:"POST"})}),{onSuccess:function(t){var r=n.getQueryData(e);n.setQueryData(e,[].concat(Object(W.a)(r),[t]))}})}function gn(e){var t=q();return Object(P.useMutation)((function(e){return t("epics/".concat(e.id),{data:e,method:"PATCH"})}),oe(e))}var yn,wn,In,kn,Cn,Ln,En,_n,Tn,Mn,Sn=function(){var e,t=null===(e=Object(pe.f)().pathname.match(/project\/(\d+)/))||void 0===e?void 0:e[1];return Number(t)},Nn=function(){return[{projectId:Sn()}]},Pn=function(){var e=Nn();return["epics",Object(o.a)(e,1)[0]]},Dn=function(){var e=V(["epicCreate"]),t=Object(o.a)(e,2),n=t[0].epicCreate,r=t[1],a=K(),c=V(["editingEpictId"]),i=Object(o.a)(c,2),u=i[0].editingEpictId,s=i[1],d=function(e){var t=q();return Object(P.useQuery)(["project",{id:e}],(function(){return t("epics/".concat(e))}),{enabled:!!e})}(Number(u)),l=d.data,j=d.isLoading;return{epicModalOpen:"true"===n||Boolean(u),open:function(){return r({epicCreate:!0})},close:function(){a({epicCreate:"",editingEpictId:""})},startEdit:function(e){s({editingEpictId:e})},editingEpic:l,isLoading:j}},Fn=L.a.div(yn||(yn=Object(C.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 80vh;\n  justify-content: center;\n  align-items: center;\n\n  .ant-form {\n    max-width: 40rem;\n    width: 100%;\n  }\n\n  .modal-button {\n    .ant-form-item-control-input-content {\n      text-align: end;\n    }\n  }\n"]))),Qn=function(){var e=Dn(),t=e.epicModalOpen,n=e.close,a=e.editingEpic,c=e.isLoading,i=a?"\u7de8\u8f2f\u4efb\u52d9\u7d44":"\u5275\u5efa\u4efb\u52d9\u7d44",u=(a?gn:xn)(Pn()),s=u.mutateAsync,d=u.error,l=u.isLoading,j=Sn(),f=Object(tt.useForm)(),p=Object(o.a)(f,1)[0];return Object(r.useEffect)((function(){p.setFieldsValue(a)}),[a,p]),Object(_.jsxs)(Ve.a,{forceRender:!0,onClose:function(){p.resetFields(),n()},visible:t,width:"100%",children:[Object(_.jsx)("h2",{children:i}),Object(_.jsx)(S,{error:d}),Object(_.jsx)(Fn,{children:c?Object(_.jsx)(k.a,{size:"large"}):Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)(We.a,{form:p,layout:"vertical",onFinish:function(e){console.log(Object(b.a)(Object(b.a)(Object(b.a)({},a),e),{},{projectId:j})),s(Object(b.a)(Object(b.a)(Object(b.a)({},a),e),{},{projectId:j})).then((function(){p.resetFields(),n()}))},children:[Object(_.jsx)(We.a.Item,{label:"\u540d\u7a31",name:"name",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u9805\u76ee\u540d\u7a31"}],children:Object(_.jsx)(Ue.a,{placeholder:"\u8acb\u8f38\u5165\u9805\u76ee\u540d\u7a31"})}),Object(_.jsx)(We.a.Item,{className:"modal-button",children:Object(_.jsx)(Oe.a,{loading:l,type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})})})]})},qn=L.a.div(wn||(wn=Object(C.a)(["\n  width: 100%;\n"]))),Rn=function(e){var t=ee(Sn()).data,n=Nn(),r=function(e){var t=q();return Object(P.useQuery)(["epics",e],(function(){return t("epics",{data:e})}))}(Object(o.a)(n,1)[0]),a=r.data,c=r.isLoading,i=_t({projectId:null===t||void 0===t?void 0:t.id}),u=i.data,s=i.isLoading,d=Dn(),l=d.open,j=d.startEdit,b=function(e){var t=q();return Object(P.useMutation)((function(e){var n=e.id;return t("epics/".concat(n),{method:"DELETE"})}),ie(e))}(Pn()).mutate,f=c||s;return Object(_.jsxs)(qn,{children:[Object(_.jsxs)(Me,{between:!0,gap:0,children:[Object(_.jsxs)("h2",{children:[null===t||void 0===t?void 0:t.name,"\u4efb\u52d9\u7d44"]}),Object(_.jsx)(Oe.a,{onClick:function(){return l()},children:"\u5275\u5efa\u4efb\u52d9\u7d44"})]}),Object(_.jsx)(qe.b,{dataSource:a,itemLayout:"vertical",rowKey:"id",loading:f,renderItem:function(e){var n,r;return Object(_.jsxs)(qe.b.Item,{children:[Object(_.jsx)(qe.b.Item.Meta,{title:Object(_.jsxs)(Me,{between:!0,gap:0,children:[Object(_.jsx)("span",{children:e.name}),Object(_.jsx)(vt,{handleDelete:function(){return b({id:e.id})},handleEdit:function(){return j(e.id)}})]}),description:Object(_.jsxs)("div",{children:[Object(_.jsxs)("div",{children:["\u958b\u59cb\u6642\u9593: ",dt(null===(n=e.start)||void 0===n?void 0:n.toString())]}),Object(_.jsxs)("div",{children:["\u7d50\u675f\u6642\u9593: ",dt(null===(r=e.end)||void 0===r?void 0:r.toString())]})]})}),Object(_.jsx)("div",{children:null===u||void 0===u?void 0:u.filter((function(t){return t.epicId===e.id})).map((function(e){return Object(_.jsx)("div",{children:Object(_.jsx)(J.b,{to:"/project/".concat(null===t||void 0===t?void 0:t.id,"/kanban?editingTaskId=").concat(e.id),children:e.name})},e.id)}))})]})}}),Object(_.jsx)(Qn,{})]})},An=L.a.div(In||(In=Object(C.a)(["\n  display: flex;\n  /* flex-direction: column; */\n\n  width: 100%;\n  height: 100%;\n\n  .content {\n    width: 100%;\n  }\n\n  @media (max-width: 767px) {\n    flex-direction: column;\n\n    .content {\n      padding-top: 1.6rem;\n      display: flex;\n      flex: 1;\n    }\n  }\n\n  @media (min-width: 768px) {\n    .ant-menu {\n      width: 16rem;\n    }\n    .content {\n      box-shadow: -5px 0 5px -5px rgba(0, 0, 0, 0.1);\n      display: flex;\n      /* overflow: hidden; */\n      overflow: ",";\n      padding-left: 3.2rem;\n    }\n  }\n"])),(function(e){return"epic"!==e.routeType?"hidden":""})),zn=function(e){var t=function(){var e=Object(pe.f)().pathname.split("/");return e[e.length-1]}(),n=(0,kt.a.useBreakpoint)().md;return Object(_.jsxs)(An,{routeType:t,children:[Object(_.jsxs)(mt.a,{mode:n?"inline":"horizontal",selectedKeys:[t],children:[Object(_.jsx)(mt.a.Item,{children:Object(_.jsx)(J.b,{to:"kanban",children:"\u770b\u677f"})},"kanban"),Object(_.jsx)(mt.a.Item,{children:Object(_.jsx)(J.b,{to:"epic",children:"\u4efb\u52d9\u7d44"})},"epic")]}),Object(_.jsx)("div",{className:"content",children:Object(_.jsxs)(pe.d,{children:[Object(_.jsx)(pe.b,{path:"/",element:Object(_.jsx)(pe.a,{to:"kanban",replace:!0})}),Object(_.jsx)(pe.b,{path:"/kanban",element:Object(_.jsx)(vn,{})}),Object(_.jsx)(pe.b,{path:"/epic",element:Object(_.jsx)(Rn,{})})]})})]})},Bn=L.a.div(kn||(kn=Object(C.a)(["\n  /* padding: 1.6rem; */\n  /* overflow: hidden; */\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]))),Zn=L.a.main(Cn||(Cn=Object(C.a)(["\n  padding: 0 2.4rem;\n  padding-bottom: 2.4rem;\n  display: flex;\n  flex: 1;\n  overflow: ",";\n\n  @media (max-width: 767px) {\n    overflow: auto;\n  }\n"])),(function(e){return"epic"===e.routeType?"auto":"hidden"})),Hn=function(e){Z("\u9805\u76ee\u5217\u8868",!1);var t=function(){var e=Object(pe.f)().pathname.split("/");return e[e.length-1]}();return Object(_.jsxs)(Bn,{children:[Object(_.jsx)(Ke,{}),Object(_.jsx)(Zn,{routeType:t,children:Object(_.jsxs)(pe.d,{children:[Object(_.jsx)(pe.b,{path:"/",element:Object(_.jsx)(pe.a,{to:"/project",replace:!0})}),Object(_.jsx)(pe.b,{path:"/project",element:Object(_.jsx)(It,{})}),Object(_.jsx)(pe.b,{path:"/project/:id/*",element:Object(_.jsx)(zn,{})})]})}),Object(_.jsx)(rt,{})]})},Jn=L.a.div(Ln||(Ln=Object(C.a)(["\n  display: flex;\n  justify-content: center;\n"]))),Kn=Object(L.a)(Zt.a)(En||(En=Object(C.a)(["\n  width: 40rem;\n  min-height: 56rem;\n  padding: 3.2rem;\n  border-radius: 0.3rem;\n  box-shadow: rgba(0, 0, 0, 0.1) 0 0 10px;\n  text-align: center;\n  margin-top: 6rem;\n\n  @media (max-height: 600px) {\n    margin-top: 0rem;\n    height: 100vh;\n  }\n"]))),Vn=L.a.div(_n||(_n=Object(C.a)(["\n  background: url(",") no-repeat center;\n  padding: 4rem 0;\n  background-size: 8rem;\n  width: 100%;\n"])),n(480).default),Wn=Object(L.a)(Oe.a)(Tn||(Tn=Object(C.a)(["\n  width: 100%;\n"]))),Un=L.a.div(Mn||(Mn=Object(C.a)(["\n  min-height: 30px;\n"]))),Yn=["cpassword"],Gn=function(e){var t=Q(),n=t.login,a=t.register,c=We.a.useForm(),i=Object(o.a)(c,1)[0],u=Object(r.useState)("login"),s=Object(o.a)(u,2),d=s[0],b=s[1],p=Object(r.useState)(null),O=Object(o.a)(p,2),m=O[0],h=O[1],v=B(void 0,{throwOnError:!0}),x=v.run,g=v.isLoading;!function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1];Object(r.useEffect)((function(){return a(!0),function(){return a(!1)}}),[])}(),Z("\u8acb\u767b\u5165\u8a3b\u518a\u4ee5\u7e7c\u7e8c");var y=function(){var e=Object(j.a)(l.a.mark((function e(t){var r,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.cpassword,c=Object(f.a)(t,Yn),"register"!==d){e.next=4;break}if(c.password===r){e.next=4;break}return e.abrupt("return",h(new Error("\u8acb\u78ba\u8a8d\u5169\u6b21\u8f38\u5165\u7684\u5bc6\u78bc\u76f8\u540c")));case 4:return i="login"===d?n:a,e.prev=5,e.next=8,x(i(c));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),h(e.t0);case 13:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsx)(Jn,{children:Object(_.jsxs)(Kn,{children:[Object(_.jsx)(Vn,{}),Object(_.jsx)(Un,{children:Object(_.jsx)(S,{error:m})}),Object(_.jsxs)(We.a,{form:i,onFinish:function(e){return y(e)},children:[Object(_.jsx)(We.a.Item,{name:"username",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u7528\u6236\u540d"}],children:Object(_.jsx)(Ue.a,{autoComplete:"",placeholder:"\u7528\u6236\u540d",type:"text",id:"username"})}),Object(_.jsx)(We.a.Item,{name:"password",rules:[{required:!0,message:"\u8acb\u8f38\u5165\u5bc6\u78bc"}],children:Object(_.jsx)(Ue.a,{autoComplete:"",placeholder:"\u5bc6\u78bc",type:"password",id:"password"})}),"register"===d&&Object(_.jsx)(We.a.Item,{name:"cpassword",rules:[{required:!0,message:"\u8acb\u78ba\u8a8d\u5bc6\u78bc"}],children:Object(_.jsx)(Ue.a,{autoComplete:"new-password",placeholder:"\u78ba\u8a8d\u5bc6\u78bc",type:"password",id:"cpassword"})}),Object(_.jsx)(Wn,{loading:g,htmlType:"submit",type:"primary",children:"login"===d?"\u767b\u9304":"\u8a3b\u518a"})]}),Object(_.jsx)(at.a,{}),Object(_.jsx)(Oe.a,{type:"link",onClick:function(){b("login"===d?"register":"login"),h(null),i.resetFields()},children:"login"===d?"\u6c92\u6709\u5e33\u865f\uff1f\u8a3b\u518a\u65b0\u5e33\u865f":"\u5df2\u7d93\u6709\u5e33\u865f\u4e86\uff1f\u76f4\u63a5\u767b\u9304"})]})})};var Xn=function(){var e=Q().user;return Object(_.jsx)(fe,{fallbackRender:N,children:Object(_.jsx)("div",{className:"App",children:e?Object(_.jsx)(Hn,{}):Object(_.jsx)(Gn,{})})})},$n=function(e){var t=e.children;return Object(_.jsx)(P.QueryClientProvider,{client:new P.QueryClient,children:Object(_.jsx)(J.a,{children:Object(_.jsx)(F,{children:t})})})},er=(n(481),n(287));(0,n(491).startServer)(),i.a.render(Object(_.jsx)(a.a.StrictMode,{children:Object(_.jsxs)($n,{children:[Object(_.jsx)(er.ReactQueryDevtools,{initialIsOpen:!1}),Object(_.jsx)(Xn,{})]})}),document.getElementById("root"))},491:function(e,t,n){"use strict";n.r(t),n.d(t,"startServer",(function(){return je}));var r=n(40),a=n(144),c=n(9),i=n.n(c),o=n(29),u=n(10),s=n(88),d=n(47),l=n(65),j=n(91),b=n(92),f=n(207),p=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).status=200,r}return n}(Object(f.a)(Error));var O=["passwordHash"],m="__jira_users__",h={},v=function(){return window.localStorage.setItem(m,JSON.stringify(h))},x=function(){return Object.assign(h,JSON.parse(window.localStorage.getItem(m)||""))};try{x()}catch(be){v()}var g=function(e){var t=e.name,n=e.password;if(!t){var r=new p("\u8bf7\u4f20\u5165\u7528\u6237\u540d");throw r.status=400,r}if(!n){var a=new p("\u8bf7\u4f20\u5165\u5bc6\u7801");throw a.status=400,a}};function y(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return String(t>>>0)}function w(e){e.passwordHash;return Object(d.a)(e,O)}var I=function(e){var t=e.name,n=e.password;g({name:t,password:n});var r=+y(t),a=h[r]||{};if(a.passwordHash===y(n))return Object(u.a)(Object(u.a)({},w(a)),{},{token:btoa(a.id+"")});var c=new p("\u7528\u6237\u540d\u6216\u5bc6\u7801\u4e0d\u6b63\u786e");throw c.status=400,c};function k(e){if(x(),!h[e]){var t=new p('\u6ca1\u6709\u627e\u5230id\u4e3a "'.concat(e,'" \u7684\u7528\u6237\uff0c\u8bf7\u5c1d\u8bd5\u6e05\u7a7a\u6570\u636e\u5e93'));throw t.status=404,t}}function C(e){return L.apply(this,arguments)}function L(){return(L=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(t),e.abrupt("return",w(h[t]));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(i.a.mark((function e(t){var n,r,a,c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,r=t.password,g({name:n,password:r}),a=+y(n),c=y(r),!h[a]){e.next=8;break}throw(o=new p('\u7528\u6237\u540d "'.concat(n,'" \u5df2\u5b58\u5728'))).status=400,o;case 8:return h[a]={id:a,name:n,passwordHash:c},v(),e.abrupt("return",C(a));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=[{name:"task"},{name:"bug"}],M=[{name:"\u521d\u59cb"},{name:"\u4e2d\u671f"},{name:"\u7d50\u9805"}],S=[{name:"\u7ba1\u7406\u7cfb\u7d71\u958b\u767c",start:new Date("2020-12-10").getTime(),end:new Date("2021-01-11").getTime()},{name:"\u5730\u5716\u7cfb\u7d71\u958b\u767c",start:new Date("2021-01-12").getTime(),end:new Date("2021-02-14").getTime()},{name:"\u5f8c\u53f0\u7cfb\u7d71\u958b\u767c",start:new Date("2021-01-12").getTime(),end:new Date("2021-02-14").getTime()}],N=[{name:"\u5f85\u5b8c\u6210"},{name:"\u958b\u767c\u4e2d"},{name:"\u5df2\u5b8c\u6210"}],P=[{name:"\u9ad8\u4fee\u6587",organization:"\u5916\u9001\u7d44"},{name:"\u96c4\u5929\u6210",organization:"\u5916\u9001\u7d44"},{name:"\u6b63\u83ef",organization:"\u7ba1\u7406\u7d44"},{name:"\u6587\u975c",organization:"\u4e2d\u53f0\u7d44"}],D=[{id:1,name:"\u5167\u5bb9\u7ba1\u7406\u7cfb\u7d71",personId:1,organization:"\u5916\u9001\u7d44",created:1604989757139}],F=[{name:"\u7ba1\u7406\u8a3b\u518a\u4ecb\u9762\u958b\u767c",tags:[1,2],reporterId:1,processorId:2,epicId:1,kanbanId:1,favorite:!0,typeId:1,note:"\u8acb\u76e1\u5feb\u5b8c\u6210"},{name:"\u7ba1\u7406\u767b\u5165\u4ecb\u9762\u958b\u767c",tags:[2],reporterId:1,processorId:2,epicId:1,kanbanId:1,favorite:!0,typeId:1,note:"\u4f7f\u7528JWT"},{name:"\u55ae\u5143\u6e2c\u8a66",tags:[1],reporterId:1,processorId:2,epicId:1,kanbanId:1,favorite:!0,typeId:1,note:""},{name:"\u6027\u80fd\u512a\u5316",tags:[1],reporterId:1,processorId:2,epicId:1,kanbanId:1,favorite:!0,typeId:1,note:""},{name:"\u6b0a\u9650\u7ba1\u7406",tags:[1],reporterId:1,processorId:2,epicId:1,kanbanId:1,favorite:!0,typeId:1,note:""},{name:"UI\u8a2d\u8a08",tags:[1],reporterId:1,processorId:2,epicId:1,kanbanId:1,favorite:!0,typeId:1,note:""},{name:"e2e\u6e2c\u8a66",tags:[1],reporterId:1,processorId:2,epicId:1,kanbanId:1,favorite:!0,typeId:1,note:""}],Q=n(106),q=n(79),R=["name"],A=function(){function e(t){var n=this;Object(l.a)(this,e),this.storageKey="",this.list=[],this.persist=function(){return window.localStorage.setItem(n.storageKey,JSON.stringify(n.list))},this.load=function(){return n.list=JSON.parse(window.localStorage.getItem(n.storageKey))||[]},this.validateItem=function(e){if(n.load(),!n.listMap[e]){var t=new p('No item with the id "'.concat(e,'"'));throw t.status=404,t}},this.detail=function(e){return n.validateItem(e),n.listMap[e]},this.remove=function(e){n.validateItem(e);var t=n.list.find((function(t){return t.id===e}));t&&(t.deleted=!0,n.persist())},this.storageKey=t;try{this.load()}catch(be){this.persist()}}return Object(q.a)(e,[{key:"listMap",get:function(){return this.list.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(Q.a)({},t.id,t))}),{})}},{key:"reorder",value:function(e){var t=e.fromId,n=e.type,r=e.referenceId,a=this.list.findIndex((function(e){return e.id===t}));if(!r)return U(this.list,a,this.list.length-1),void this.persist();var c=this.list.findIndex((function(e){return e.id===r}));("after"===n?U:W)(this.list,a,c),this.persist()}},{key:"push",value:function(e){var t=this;e.forEach((function(e){return t.create(e)})),this.persist()}},{key:"update",value:function(e,t){this.validateItem(e);var n=this.list.find((function(t){return t.id===e}));return this.list[this.list.indexOf(n)]=Object(u.a)(Object(u.a)({},n),t),this.persist(),this.detail(e)}},{key:"create",value:function(e){var t=e.name,n=void 0===t?function(e){var t=new p("".concat(e," is required"));throw t.status=400,t}("name"):t,a=Object(d.a)(e,R),c=Object.keys(this.listMap).map(Number),i=Math.max.apply(Math,Object(r.a)(c).concat([0]))+1,o=Object(u.a)(Object(u.a)({},a),{},{name:n,id:i});return this.list.push(o),this.persist(),this.detail(i)}},{key:"query",value:function(e){return function(e,t){return t?e.filter((function(e){return Object.keys(t).every((function(n){var r=t[n];return"name"===n?e.name.includes(r):Array.isArray(r)?r.find((function(t){return t==e[n]})):void 0===r||""===r||e[n]==r}))})):e}(this.list,e).filter((function(e){return!e.deleted}))}},{key:"queryByOwnerId",value:function(e,t){return this.query(t).filter((function(t){return!("ownerId"in t)||t.ownerId===e}))}}]),e}(),z=new A("__jira__project"),B=new A("__jira__epic"),Z=new A("__jira__task"),H=new A("__jira__kanban"),J=new A("__jira__user"),K=new A("__jira__task__type"),V=new A("__jira__tag__"),W=function(e,t,n){var r=e[n],a=e.splice(t,1)[0],c=e.indexOf(r);return e.splice(c,0,a),e},U=function(e,t,n){var r=e[n],a=e.splice(t,1)[0],c=e.indexOf(r);return e.splice(c+1,0,a),e};Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};var Y=function(e){return e.id},G=function(e){K.push(X(e,T)),z.push(X(e,D)),V.push(X(e,M)),H.push(X(e,N)),B.push(X(e,S)),Z.push(X(e,F)),J.push(X(e,P));var t=J.queryByOwnerId(e).map(Y),n=z.queryByOwnerId(e).map(Y),r=H.queryByOwnerId(e).map(Y),a=B.queryByOwnerId(e).map(Y),c=V.queryByOwnerId(e).map(Y),i=K.queryByOwnerId(e).map(Y);z.queryByOwnerId(e).forEach((function(e){return z.update(e.id,{personId:t.random()})})),H.queryByOwnerId(e).forEach((function(e){H.update(e.id,{projectId:n.random()})})),B.queryByOwnerId(e).forEach((function(e){B.update(e.id,{projectId:n[0]})})),Z.queryByOwnerId(e).forEach((function(e){return Z.update(e.id,{tags:[c.random()],reporterId:t.random(),processorId:t.random(),projectId:n.random(),epicId:a.random(),kanbanId:r.random(),typeId:i.random()})}))},X=function(e,t,n){return t.map((function(t){return Object(u.a)(Object(u.a)({},t),{},{ownerId:e},n)}))},$=function(e){var t;return null===(t=e.headers.get("Authorization"))||void 0===t?void 0:t.replace("Bearer ","")};function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(o.a)(i.a.mark((function e(t){var n,r,a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$(t)){e.next=5;break}throw(r=new p("A token must be provided")).status=401,r;case 5:e.prev=5,a=atob(n),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(5),(c=new p("Invalid token. Please login again.")).status=401,c;case 14:return e.next=16,C(+a);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,null,[[5,9]])})))).apply(this,arguments)}var ne=[s.c.get("".concat("","/me"),function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(t);case 2:return a=e.sent,c=$(t),e.abrupt("return",n(r.json({user:Object(u.a)(Object(u.a)({},a),{},{token:c})})));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),s.c.post("".concat("","/login"),function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,c,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.body,c=a.username,o=a.password,console.log(c,o),e.next=4,I({name:c,password:o});case 4:return u=e.sent,e.abrupt("return",n(r.json({user:u})));case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),s.c.post("".concat("","/register"),function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,c,o,u,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.body,c=a.username,o=a.password,u={name:c,password:o},e.next=4,E(u);case 4:return e.prev=4,e.next=7,I(u);case 7:s=e.sent,G(s.id),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",n(r.status(e.t0.status),r.json({message:e.t0.message})));case 14:return e.abrupt("return",n(r.json({user:s})));case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n,r){return e.apply(this,arguments)}}())],re=function(e){return Array.isArray(e)?e.map(Number):Number(e)},ae=function(e){var t={};return Object.keys(e).forEach((function(n){t[n]=n.includes("Id")?re(e[n]):e[n]})),t.id=re(t.id),t},ce=function(e,t){return[s.c.get("".concat("","/").concat(e),function(){var e=Object(o.a)(i.a.mark((function e(n,r,a){var c,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(n);case 2:return c=e.sent,o=n.url.searchParams,u=t.queryByOwnerId(c.id,Object.fromEntries(o)),e.abrupt("return",r(a.json(u)));case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),s.c.get("".concat("","/").concat(e,"/:id"),function(){var e=Object(o.a)(i.a.mark((function e(n,r,a){var c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.params.id,o=t.detail(+c),e.abrupt("return",r(a.json(o)));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),s.c.patch("".concat("","/").concat(e,"/:id"),function(){var e=Object(o.a)(i.a.mark((function e(n,r,a){var c,o,u,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=ae(n.params),o=c.id,u=n.body,s=t.update(o,u),e.abrupt("return",r(a.json(s)));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),s.c.delete("".concat("","/").concat(e,"/:id"),function(){var e=Object(o.a)(i.a.mark((function e(n,r,a){var c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=ae(n.params),o=c.id,t.remove(o),e.abrupt("return",r(a.json({success:!0})));case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),s.c.post("".concat("","/").concat(e),function(){var n=Object(o.a)(i.a.mark((function n(r,a,c){var o,s,d;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ee(r);case 2:return o=n.sent,s=Object.assign(r.body,{ownerId:o.id,created:(new Date).getTime()}),"tasks"===e&&(s=Object(u.a)(Object(u.a)({},s),{},{reporterId:o.id,typeId:K.queryByOwnerId(o.id)[0].id,created:(new Date).getTime()})),n.next=7,t.create(ae(s));case 7:return d=n.sent,n.abrupt("return",a(c.json(d)));case 9:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}())]},ie=n(288),oe=[s.c.post("".concat("","/kanbans/reorder"),function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,c,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.body,c=a.fromId,o=a.referenceId,u=a.type,e.next=3,H.reorder({fromId:c,referenceId:o,type:u});case 3:return e.abrupt("return",n(r.json({})));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),s.c.post("".concat("","/tasks/reorder"),function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,c,o,u,s,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.body,c=a.type,o=a.fromId,u=a.referenceId,s=a.fromKanbanId,d=a.toKanbanId,s===d){e.next=4;break}return e.next=4,Z.update(o,{kanbanId:d});case 4:return e.next=6,Z.reorder({type:c,fromId:o,referenceId:u});case 6:return e.abrupt("return",n(r.json({})));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())];function ue(e,t){var n,r=window.localStorage.getItem(e);return r&&(n=Number(r)),Number.isFinite(n)?n:t}var se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue("__jira_min_request_time__",200);return new Promise((function(t){return setTimeout(t,e)}))},de=[].concat(Object(r.a)(ne),Object(r.a)(ce("projects",z)),Object(r.a)(ce("epics",B)),Object(r.a)(ce("tasks",Z)),Object(r.a)(ce("kanbans",H)),Object(r.a)(ce("persons",J)),Object(r.a)(ce("taskTypes",K)),Object(r.a)(ce("tags",V)),Object(r.a)(ce("users",J)),Object(r.a)(oe)).map((function(e){var t=e.resolver;return Object.assign(e,{resolver:function(){var e=Object(o.a)(i.a.mark((function e(n,r,a){var c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!le(n)){e.next=3;break}throw new Error("\u8acb\u6c42\u5931\u6557");case 3:return e.next=5,t(n,r,a);case 5:return c=e.sent,e.abrupt("return",c);case 9:return e.prev=9,e.t0=e.catch(0),o=e.t0.status||500,e.abrupt("return",r(a.status(o),a.json({status:o,message:e.t0.message||"Unknown Error"})));case 13:return e.prev=13,e.next=16,se();case 16:return e.finish(13);case 17:case"end":return e.stop()}}),e,null,[[0,9,13,17]])})));return function(t,n,r){return e.apply(this,arguments)}}()})}));function le(e){var t,n;if(null===(t=JSON.stringify(e.body))||void 0===t?void 0:t.includes("FAIL"))return!0;if(null===(n=e.url.searchParams.toString())||void 0===n?void 0:n.includes("FAIL"))return!0;var r=Number(window.localStorage.getItem("__jira_failure_rate__")||0);return Math.random()<r||!!function(e){function t(t){var n=t.requestMethod,r=t.urlMatch;return("ALL"===n||e.method===n)&&Object(ie.a)(r,e.url.pathname).matches}try{if(JSON.parse(window.localStorage.getItem("__jira_request_fail_config__")||"[]").some(t))return!0}catch(be){window.localStorage.removeItem("__jira_request_fail_config__")}return!1}(e)}var je=function(){a.a.apply(void 0,Object(r.a)(de)).start({quiet:!0,serviceWorker:{url:"/mockServiceWorker.js"}})}}},[[490,1,2]]]);
//# sourceMappingURL=main.79fb15b2.chunk.js.map